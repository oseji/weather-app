import { useState, useEffect } from "react";
import { motion } from "framer-motion";

function App() {
  const [location, setLocation] = useState([]);
  const [apiData, setApiData] = useState(null);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState(null);

  const [locationErr, setLocationErr] = useState(null);
  const [locationLoading, setLocationLoading] = useState(true);

  const [searchVar, setSearchVar] = useState("");
  const [temp, setTemp] = useState("0째C");
  const [feelsLike, setFeelsLike] = useState("0째C");
  const [wind, setWind] = useState("0%");
  const [humidity, setHumidity] = useState("0%");
  const [pressure, setPressure] = useState("0 in");
  const [city, setCity] = useState("");
  const [country, setCountry] = useState("");
  const [time, setTime] = useState("");
  const [lastUpdated, setLastUpdated] = useState("");

  const [apiLink, setApiLink] = useState(
    `https://api.weatherapi.com/v1/current.json?key=46fb6895d1de4ad9b14163630230911&q=${location}&aqi=no`
  );

  const pathVariants = {
    hidden: {
      pathLength: 0,
      opacity: 0,
    },
    visible: {
      pathLength: 1,
      opacity: 1,
      transition: { duration: 1 },
    },
  };

  const sunny = (
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="128"
      height="128"
      xml:space="preserve"
    >
      <motion.path
        variants={pathVariants}
        initial="hidden"
        animate="visible"
        fill="#FFF"
        d="m89.717 17.396 3.928.847-2.67 12.383-3.927-.846zM69.924 18.72l3.854 12.066-3.828 1.223-3.854-12.066zM49.612 31.039l9.344 8.514-2.706 2.97-9.345-8.513zM109.038 83.369l9.343 8.515-2.706 2.97-9.343-8.516zM115.679 67.377l12.33 2.681-.854 3.926-12.33-2.681zM125.457 46.337l1.231 3.824-12.016 3.87-1.231-3.825zM111.452 27.057l2.983 2.694-8.477 9.387-2.983-2.694z"
      />
      <g>
        <motion.path
          variants={pathVariants}
          initial="hidden"
          animate="visible"
          fill="#FFF"
          d="m94.467 89.071-1.672-3.652c8.753-4.003 14.407-12.824 14.407-22.477 0-13.604-11.016-24.671-24.556-24.671-9.563 0-18.328 5.646-22.325 14.385l-3.653-1.672c4.649-10.163 14.848-16.73 25.979-16.73 15.755 0 28.573 12.87 28.573 28.688 0 11.22-6.576 21.476-16.753 26.129z"
        />
      </g>
      <g>
        <motion.path
          variants={pathVariants}
          initial="hidden"
          animate="visible"
          fill="#FFF"
          d="M93.46 110.602H18.509C8.303 110.602 0 102.265 0 92.017c0-8.853 6.185-16.376 14.649-18.175.795-15.373 13.506-27.634 29.017-27.634 13.715 0 25.558 9.756 28.396 23.024a19.928 19.928 0 0 1 3.366-.29c11.27 0 20.439 9.207 20.439 20.523 0 .148-.002.298-.006.449 4.648 1.077 8.046 5.219 8.044 10.202.001 5.782-4.685 10.486-10.445 10.486zM43.666 50.226c-13.806 0-25.039 11.281-25.039 25.147l.005 1.971-1.779.205c-7.317.84-12.835 7.061-12.835 14.468 0 8.032 6.501 14.567 14.491 14.567H93.46c3.544 0 6.428-2.901 6.428-6.468.002-3.515-2.732-6.349-6.227-6.452l-2.185-.065.249-2.172c.084-.73.124-1.372.124-1.961 0-9.102-7.367-16.506-16.421-16.506-1.46 0-2.953.211-4.438.628l-2.221.623-.312-2.286c-1.686-12.37-12.345-21.699-24.791-21.699z"
        />
      </g>
      <g>
        <motion.path
          variants={pathVariants}
          initial="hidden"
          animate="visible"
          fill="#FFF"
          d="m27.925 76.648-4.018-.016c.043-11.628 9.502-21.089 21.085-21.089v4.018c-9.376.001-17.032 7.667-17.067 17.087z"
        />
      </g>
    </svg>
  );

  const sunny2 = (
    <svg
      width="128"
      height="128"
      viewBox="0 0 16 16"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <g>
        <motion.path
          variants={pathVariants}
          initial="hidden"
          animate="visible"
          d="M7.65531 2.35743C7.74912 2.45124 7.87634 2.50394 8.009 2.50394C8.14166 2.50394 8.26888 2.45124 8.36269 2.35743C8.45649 2.26363 8.50919 2.13641 8.50919 2.00375V0.503186C8.50919 0.370528 8.45649 0.243303 8.36269 0.1495C8.26888 0.0556965 8.14166 0.00299835 8.009 0.00299835C7.87634 0.00299835 7.74912 0.0556965 7.65531 0.1495C7.56151 0.243303 7.50881 0.370528 7.50881 0.503186V2.00375C7.50881 2.13641 7.56151 2.26363 7.65531 2.35743Z"
          fill="#FFF"
        />
        <motion.path
          variants={pathVariants}
          initial="hidden"
          animate="visible"
          d="M3.57517 4.21831C3.63577 4.24355 3.70076 4.25656 3.76641 4.25659L3.76741 4.25559C3.86647 4.25577 3.96335 4.22653 4.04577 4.17158C4.12819 4.11663 4.19244 4.03845 4.23037 3.94694C4.2683 3.85543 4.27821 3.75472 4.25883 3.65758C4.23946 3.56043 4.19168 3.47123 4.12154 3.40127L3.05814 2.34188C2.96381 2.25076 2.83746 2.20035 2.70631 2.20149C2.57516 2.20263 2.44971 2.25523 2.35697 2.34797C2.26423 2.44071 2.21163 2.56616 2.21049 2.69731C2.20935 2.82846 2.25977 2.9548 2.35088 3.04914L3.41328 4.10954C3.45955 4.15611 3.51456 4.19307 3.57517 4.21831Z"
          fill="#FFF"
        />
        <motion.path
          variants={pathVariants}
          initial="hidden"
          animate="visible"
          d="M0.503186 8.49618H2.00375C2.13641 8.49618 2.26363 8.44349 2.35743 8.34968C2.45124 8.25588 2.50394 8.12865 2.50394 7.996C2.50394 7.86334 2.45124 7.73611 2.35743 7.64231C2.26363 7.54851 2.13641 7.49581 2.00375 7.49581H0.503186C0.370528 7.49581 0.243303 7.54851 0.1495 7.64231C0.0556965 7.73611 0.00299835 7.86334 0.00299835 7.996C0.00299835 8.12865 0.0556965 8.25588 0.1495 8.34968C0.243303 8.44349 0.370528 8.49618 0.503186 8.49618Z"
          fill="#FFF"
        />
        <motion.path
          variants={pathVariants}
          initial="hidden"
          animate="visible"
          d="M2.41665 13.7172C2.49907 13.7721 2.59595 13.8013 2.69501 13.8012C2.76066 13.8011 2.82565 13.7881 2.88625 13.7629C2.94685 13.7377 3.00187 13.7007 3.04814 13.6541L4.11054 12.5937C4.20165 12.4994 4.25207 12.373 4.25093 12.2419C4.24979 12.1107 4.19718 11.9853 4.10445 11.8925C4.01171 11.7998 3.88625 11.7472 3.75511 11.7461C3.62396 11.7449 3.49761 11.7953 3.40327 11.8865L2.34087 12.9469C2.27074 13.0168 2.22296 13.106 2.20359 13.2032C2.18421 13.3003 2.19412 13.401 2.23205 13.4925C2.26998 13.584 2.33423 13.6622 2.41665 13.7172Z"
          fill="#FFF"
        />
        <motion.path
          variants={pathVariants}
          initial="hidden"
          animate="visible"
          d="M7.64231 15.8565C7.73611 15.9503 7.86334 16.003 7.996 16.003C8.12865 16.003 8.25588 15.9503 8.34968 15.8565C8.44349 15.7627 8.49618 15.6355 8.49618 15.5028V14.0022C8.49618 13.8696 8.44349 13.7424 8.34968 13.6486C8.25588 13.5548 8.12865 13.5021 7.996 13.5021C7.86334 13.5021 7.73611 13.5548 7.64231 13.6486C7.54851 13.7424 7.49581 13.8696 7.49581 14.0022V15.5028C7.49581 15.6355 7.54851 15.7627 7.64231 15.8565Z"
          fill="#FFF"
        />
        <motion.path
          variants={pathVariants}
          initial="hidden"
          animate="visible"
          d="M13.1087 13.7729C13.1693 13.7981 13.2343 13.8111 13.3 13.8112C13.399 13.8112 13.4957 13.7818 13.578 13.7267C13.6602 13.6717 13.7243 13.5935 13.7621 13.5021C13.7999 13.4106 13.8098 13.31 13.7904 13.2129C13.771 13.1159 13.7232 13.0268 13.6531 12.9569L12.5927 11.8965C12.547 11.8469 12.4918 11.807 12.4303 11.7794C12.3688 11.7517 12.3024 11.7367 12.2349 11.7354C12.1675 11.734 12.1005 11.7463 12.038 11.7715C11.9754 11.7967 11.9186 11.8343 11.871 11.882C11.8233 11.9297 11.7858 11.9866 11.7607 12.0492C11.7356 12.1117 11.7234 12.1788 11.7249 12.2462C11.7263 12.3136 11.7414 12.38 11.7691 12.4415C11.7969 12.5029 11.8368 12.5581 11.8865 12.6037L12.9469 13.6641C12.9931 13.7107 13.0481 13.7477 13.1087 13.7729Z"
          fill="#FFF"
        />
        <motion.path
          variants={pathVariants}
          initial="hidden"
          animate="visible"
          d="M14.0022 8.51019H15.5028C15.6355 8.51019 15.7627 8.45749 15.8565 8.36369C15.9503 8.26988 16.003 8.14266 16.003 8.01C16.003 7.87734 15.9503 7.75012 15.8565 7.65632C15.7627 7.56251 15.6355 7.50981 15.5028 7.50981H14.0022C13.8696 7.50981 13.7424 7.56251 13.6486 7.65632C13.5548 7.75012 13.5021 7.87734 13.5021 8.01C13.5021 8.14266 13.5548 8.26988 13.6486 8.36369C13.7424 8.45749 13.8696 8.51019 14.0022 8.51019Z"
          fill="#FFF"
        />
        <motion.path
          variants={pathVariants}
          initial="hidden"
          animate="visible"
          d="M11.9712 4.18259C12.0537 4.23754 12.1505 4.26677 12.2496 4.2666C12.3154 4.26669 12.3806 4.25375 12.4414 4.22851C12.5022 4.20327 12.5573 4.16623 12.6037 4.11954L13.6641 3.05914C13.7106 3.01264 13.7474 2.95744 13.7725 2.89671C13.7976 2.83597 13.8105 2.77088 13.8105 2.70516C13.8104 2.63944 13.7974 2.57437 13.7722 2.51367C13.747 2.45296 13.7101 2.39782 13.6636 2.35138C13.6171 2.30494 13.5619 2.26811 13.5012 2.24301C13.4404 2.2179 13.3754 2.205 13.3096 2.20505C13.2439 2.20509 13.1788 2.21808 13.1181 2.24328C13.0574 2.26847 13.0023 2.30537 12.9559 2.35188L11.8955 3.41228C11.8253 3.48223 11.7775 3.57144 11.7582 3.66858C11.7388 3.76573 11.7487 3.86644 11.7866 3.95794C11.8246 4.04945 11.8888 4.12764 11.9712 4.18259Z"
          fill="#FFF"
        />
        <motion.path
          variants={pathVariants}
          initial="hidden"
          animate="visible"
          d="M5.50493 4.25839C6.24495 3.76392 7.11498 3.5 8.005 3.5C9.19847 3.5 10.3431 3.97411 11.187 4.81802C12.0309 5.66193 12.505 6.80653 12.505 8C12.505 8.89002 12.2411 9.76005 11.7466 10.5001C11.2521 11.2401 10.5493 11.8169 9.72708 12.1575C8.90481 12.4981 8.00001 12.5872 7.12709 12.4135C6.25418 12.2399 5.45235 11.8113 4.82302 11.182C4.19368 10.5526 3.7651 9.75082 3.59147 8.87791C3.41783 8.00499 3.50695 7.10019 3.84754 6.27792C4.18814 5.45566 4.76491 4.75285 5.50493 4.25839ZM9.9495 5.08986C9.37392 4.70527 8.69723 4.5 8.005 4.5C7.07707 4.50106 6.18744 4.87015 5.53129 5.5263C4.87515 6.18244 4.50606 7.07207 4.505 8C4.505 8.69223 4.71027 9.36892 5.09486 9.9445C5.47944 10.5201 6.02607 10.9687 6.66561 11.2336C7.30515 11.4985 8.00888 11.5678 8.68781 11.4327C9.36675 11.2977 9.99039 10.9644 10.4799 10.4749C10.9694 9.98539 11.3027 9.36175 11.4377 8.68282C11.5728 8.00388 11.5035 7.30015 11.2386 6.66061C10.9737 6.02107 10.5251 5.47444 9.9495 5.08986Z"
          fill="#FFF"
        />
      </g>
    </svg>
  );

  const cloudy = (
    <svg
      width="16"
      height="16"
      viewBox="0 0 16 16"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M8.40623 15.9851C9.76855 15.9851 10.9951 15.4272 11.8516 14.5364C11.938 14.4465 12.0742 14.4184 12.1933 14.4616C12.5024 14.5737 12.8375 14.6351 13.1875 14.6351C14.7408 14.6351 16 13.4263 16 11.9351C16 10.444 14.7408 9.23512 13.1875 9.23512C13.0295 9.23512 12.8746 9.24763 12.7238 9.27165C12.5983 9.29164 12.4707 9.23858 12.4042 9.13453C11.5798 7.84514 10.0977 6.98512 8.40623 6.98512C6.72405 6.98512 5.24882 7.83578 4.42185 9.11344C4.35858 9.2112 4.24078 9.26375 4.1216 9.25124C4.02009 9.24059 3.91696 9.23512 3.8125 9.23512C2.2592 9.23512 1 10.444 1 11.9351C1 13.4263 2.2592 14.6351 3.8125 14.6351C4.1154 14.6351 4.40712 14.5892 4.68049 14.5041C4.79476 14.4685 4.92146 14.4971 5.0041 14.5808C5.85835 15.4457 7.06667 15.9851 8.40623 15.9851ZM12.0672 13.3786C11.9059 13.263 11.6569 13.2915 11.5467 13.4533C10.8771 14.4359 9.72066 15.0851 8.40623 15.0851C7.12396 15.0851 5.99201 14.4673 5.31577 13.5248C5.21044 13.378 4.98975 13.3475 4.83414 13.4447C4.54023 13.6284 4.18935 13.7351 3.8125 13.7351C2.77697 13.7351 1.9375 12.9292 1.9375 11.9351C1.9375 10.941 2.77697 10.1351 3.8125 10.1351C4.05316 10.1351 4.28324 10.1787 4.49464 10.258C4.66778 10.3229 4.87784 10.25 4.95016 10.0856C5.51901 8.79256 6.85223 7.88512 8.40623 7.88512C9.98142 7.88512 11.3298 8.81748 11.8851 10.1387C11.9606 10.3182 12.1995 10.3927 12.3815 10.3094C12.6257 10.1977 12.899 10.1351 13.1875 10.1351C14.223 10.1351 15.0625 10.941 15.0625 11.9351C15.0625 12.9292 14.223 13.7351 13.1875 13.7351C12.7675 13.7351 12.3798 13.6026 12.0672 13.3786Z"
        fill="black"
      />
      <path
        d="M4.995 1.76212C5.02046 1.8766 5.08415 1.97899 5.17558 2.05242C5.26701 2.12586 5.38073 2.16596 5.498 2.16612C5.53565 2.16607 5.57319 2.16205 5.61 2.15412C5.74357 2.12425 5.85985 2.04262 5.93333 1.92715C6.00682 1.81167 6.03151 1.67177 6.002 1.53812L5.746 0.388119C5.71066 0.260667 5.62773 0.151652 5.51433 0.0835827C5.40092 0.0155136 5.26572 -0.00641149 5.13662 0.0223344C5.00752 0.0510804 4.89438 0.128302 4.82058 0.238056C4.74677 0.347809 4.71793 0.481713 4.74 0.612119L4.995 1.76212ZM1.273 3.52012L2.267 4.15312C2.38235 4.22515 2.52147 4.24873 2.65411 4.21874C2.78675 4.18875 2.90219 4.1076 2.97533 3.99296C3.04846 3.87831 3.07339 3.73942 3.04467 3.6065C3.01596 3.47358 2.93594 3.35736 2.822 3.28312L1.827 2.65012C1.71175 2.58207 1.57456 2.56147 1.44441 2.59266C1.31425 2.62385 1.2013 2.7044 1.12941 2.8173C1.05752 2.93019 1.03231 3.06661 1.0591 3.19774C1.08589 3.32887 1.16259 3.44447 1.273 3.52012ZM0.878001 8.02812L2.028 7.77212C2.09419 7.75748 2.15684 7.72994 2.21239 7.69109C2.26793 7.65223 2.31528 7.60281 2.35173 7.54566C2.38817 7.4885 2.413 7.42473 2.42481 7.35798C2.43661 7.29123 2.43514 7.22281 2.4205 7.15662C2.40586 7.09043 2.37832 7.02778 2.33947 6.97223C2.30061 6.91669 2.25119 6.86934 2.19404 6.8329C2.13689 6.79645 2.07311 6.77162 2.00636 6.75981C1.93961 6.74801 1.87119 6.74948 1.805 6.76412L0.655001 7.02012C0.530711 7.0474 0.420885 7.11965 0.346622 7.22298C0.27236 7.32631 0.238897 7.45344 0.252664 7.57994C0.26643 7.70645 0.326454 7.8234 0.421206 7.90834C0.515957 7.99328 0.638752 8.04021 0.766001 8.04012C0.803653 8.04007 0.841194 8.03605 0.878001 8.02812ZM11.116 5.74812C11.1537 5.74807 11.1912 5.74405 11.228 5.73612L12.378 5.48012C12.4442 5.46541 12.5068 5.43781 12.5623 5.39889C12.6179 5.35998 12.6652 5.31051 12.7016 5.25331C12.738 5.1961 12.7628 5.13229 12.7745 5.06552C12.7862 4.99874 12.7847 4.93031 12.77 4.86412C12.7553 4.79793 12.7277 4.73529 12.6888 4.67977C12.6499 4.62425 12.6004 4.57694 12.5432 4.54054C12.486 4.50414 12.4222 4.47936 12.3554 4.46762C12.2886 4.45588 12.2202 4.45741 12.154 4.47212L11.004 4.72812C10.8796 4.75542 10.7697 4.82774 10.6955 4.93118C10.6212 5.03462 10.5878 5.16187 10.6017 5.28844C10.6156 5.41502 10.6758 5.53198 10.7708 5.61684C10.8657 5.7017 10.9887 5.74846 11.116 5.74812ZM8.772 2.71312C8.88739 2.78651 9.02719 2.81109 9.1607 2.78146C9.2942 2.75184 9.41048 2.67043 9.484 2.55512L10.117 1.56112C10.185 1.44587 10.2057 1.30868 10.1745 1.17852C10.1433 1.04837 10.0627 0.935421 9.94982 0.863531C9.83693 0.791641 9.70051 0.76643 9.56938 0.793221C9.43825 0.820012 9.32265 0.896708 9.247 1.00712L8.614 2.00112C8.54061 2.11651 8.51603 2.25631 8.54566 2.38982C8.57528 2.52332 8.65669 2.6396 8.772 2.71312ZM3.07 7.01712C3.14086 7.32049 3.25184 7.61307 3.4 7.88712C3.72778 7.77648 4.03495 7.61226 4.309 7.40112C4.20466 7.20971 4.12631 7.00524 4.076 6.79312C3.93178 6.14493 4.05092 5.466 4.40723 4.90566C4.76354 4.34531 5.32784 3.94944 5.976 3.80512C6.29698 3.73316 6.629 3.72525 6.95305 3.78185C7.27709 3.83845 7.58677 3.95844 7.86435 4.13495C8.14193 4.31146 8.38195 4.54101 8.57065 4.81045C8.75935 5.07989 8.89302 5.38392 8.964 5.70512C8.967 5.71812 8.966 5.73112 8.969 5.74312C9.33085 5.79045 9.68699 5.87421 10.032 5.99312C10.0243 5.82119 10.0039 5.65006 9.971 5.48112C9.76731 4.56586 9.20838 3.769 8.41717 3.26584C7.62595 2.76268 6.66726 2.59443 5.752 2.79812C4.83674 3.00181 4.03988 3.56074 3.53672 4.35195C3.03356 5.14317 2.86631 6.10186 3.07 7.01712Z"
        fill="black"
      />
    </svg>
  );

  const raining = (
    <svg
      width="16"
      height="16"
      viewBox="0 0 16 16"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M8.94251 11.7036C9.06085 11.4793 8.99063 11.1924 8.78565 11.0629C8.58068 10.9334 8.31858 11.0103 8.20024 11.2346L6.05749 15.2964C5.93915 15.5207 6.00937 15.8076 6.21435 15.9371C6.41932 16.0666 6.68142 15.9897 6.79976 15.7654L8.94251 11.7036Z"
        fill="black"
      />
      <path
        d="M2.79995 11.5559C2.99125 11.671 3.0568 11.926 2.94635 12.1254L1.74643 14.2915C1.63598 14.4909 1.39136 14.5592 1.20005 14.4441C1.00875 14.329 0.943203 14.074 1.05365 13.8746L2.25357 11.7085C2.36402 11.5091 2.60864 11.4408 2.79995 11.5559Z"
        fill="black"
      />
      <path
        d="M5.79995 11.5559C5.99125 11.671 6.0568 11.926 5.94635 12.1254L4.74643 14.2915C4.63598 14.4909 4.39136 14.5592 4.20005 14.4441C4.00875 14.329 3.9432 14.074 4.05365 13.8746L5.25357 11.7085C5.36402 11.5091 5.60864 11.4408 5.79995 11.5559Z"
        fill="black"
      />
      <path
        d="M14.7999 11.5559C14.9913 11.671 15.0568 11.926 14.9463 12.1254L13.7464 14.2915C13.636 14.4909 13.3914 14.5592 13.2001 14.4441C13.0087 14.329 12.9432 14.074 13.0537 13.8746L14.2536 11.7085C14.364 11.5091 14.6086 11.4408 14.7999 11.5559Z"
        fill="black"
      />
      <path
        d="M11.9463 12.1254C12.0568 11.926 11.9913 11.671 11.7999 11.5559C11.6086 11.4408 11.364 11.5091 11.2536 11.7085L10.0537 13.8746C9.9432 14.074 10.0087 14.329 10.2001 14.4441C10.3914 14.5592 10.636 14.4909 10.7464 14.2915L11.9463 12.1254Z"
        fill="black"
      />
      <path
        d="M7.89998 10C9.35312 10 10.6615 9.3801 11.575 8.39032C11.6672 8.29047 11.8124 8.25914 11.9395 8.30718C12.2692 8.4318 12.6267 8.5 13 8.5C14.6569 8.5 16 7.15685 16 5.5C16 3.84315 14.6569 2.5 13 2.5C12.8315 2.5 12.6663 2.51389 12.5053 2.54059C12.3715 2.56279 12.2354 2.50384 12.1645 2.38823C11.2852 0.955579 9.70416 0 7.89998 0C6.10565 0 4.53208 0.945171 3.64997 2.3648C3.58248 2.47342 3.45684 2.53181 3.32971 2.51791C3.22143 2.50607 3.11143 2.5 3 2.5C1.34315 2.5 0 3.84315 0 5.5C0 7.15685 1.34315 8.5 3 8.5C3.3231 8.5 3.63426 8.44892 3.92586 8.35441C4.04774 8.3149 4.18289 8.34663 4.27104 8.43961C5.18224 9.40064 6.47112 10 7.89998 10ZM11.805 7.10391C11.6329 6.97547 11.3674 7.00712 11.2498 7.18684C10.5356 8.27865 9.30203 9 7.89998 9C6.53223 9 5.32481 8.31351 4.60349 7.2663C4.49114 7.10319 4.25573 7.06925 4.08975 7.17731C3.77625 7.38141 3.40197 7.5 3 7.5C1.89543 7.5 1 6.60457 1 5.5C1 4.39543 1.89543 3.5 3 3.5C3.25671 3.5 3.50212 3.54836 3.72762 3.63648C3.9123 3.70864 4.13636 3.62762 4.2135 3.44496C4.82027 2.00827 6.24238 1 7.89998 1C9.58019 1 11.0184 2.03595 11.6108 3.50397C11.6913 3.70341 11.9462 3.78625 12.1403 3.69369C12.4007 3.56951 12.6922 3.5 13 3.5C14.1046 3.5 15 4.39543 15 5.5C15 6.60457 14.1046 7.5 13 7.5C12.552 7.5 12.1384 7.35271 11.805 7.10391Z"
        fill="black"
      />
    </svg>
  );

  const mapPin = (
    <svg
      class="w-6 h-6 text-gray-800 dark:text-white"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 17 21"
    >
      <g
        stroke="currentColor"
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
      >
        <motion.path
          variants={pathVariants}
          initial="hidden"
          animate="visible"
          d="M8 12a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"
        />
        <motion.path
          variants={pathVariants}
          initial="hidden"
          animate="visible"
          d="M13.8 12.938h-.01a7 7 0 1 0-11.465.144h-.016l.141.17c.1.128.2.252.3.372L8 20l5.13-6.248c.193-.209.373-.429.54-.66l.13-.154Z"
        />
      </g>
    </svg>
  );

  //GET LOCATION
  useEffect(() => {
    const getLocation = () => {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          (e) => {
            //console.log(e);
            setLocation([e.coords.latitude, e.coords.longitude]);
            //setSearchVar(location);

            setApiLink(
              `https://api.weatherapi.com/v1/current.json?key=46fb6895d1de4ad9b14163630230911&q=${[
                e.coords.latitude,
                e.coords.longitude,
              ]}&aqi=no`
            );

            console.log(location);

            setLocationLoading(false);
          },
          (err) => {
            setLocationErr(err.message);
            console.log(locationErr);

            setLocationLoading(false);
          }
        );
      } else {
        setLocationErr("Location not available");
        console.log(locationErr);

        setLocationLoading(false);
      }

      // console.log(location);
    };

    getLocation();
  }, [locationLoading]);

  //FETCH DATA FROM API
  const fetchData = async () => {
    try {
      const response = await fetch(apiLink);

      if (!response.ok) {
        throw new Error("Network response was not ok");
      }

      const data = await response.json();
      setApiData(data);
      setTemp(`${data.current.temp_c}째C`);
      setFeelsLike(`${data.current.feelslike_c} 째C`);
      setWind(`${data.current.wind_kph} km/h`);
      setHumidity(`${data.current.humidity} %`);
      setPressure(`${data.current.pressure_in} in`);
      setCity(data.location.name);
      setCountry(data.location.country);
      setTime(data.location.localtime);
      setLastUpdated(data.current.last_updated);

      setIsLoading(false);
    } catch (error) {
      setError(error);
      alert(error);

      setIsLoading(false);
    }

    console.log(apiData);
  };

  useEffect(() => {
    if (!locationLoading) {
      fetchData();
    }
  }, [isLoading, apiLink]);

  return (
    <div className="app ">
      <header>
        <motion.div
          initial={{ opacity: 0, y: -200 }}
          animate={{ opacity: 1, y: 0, transition: { duration: 1 } }}
          className="flex flex-col md:flex-row md:justify-between items-center gap-2 md:gap-0 mb-10"
        >
          <h1 className="text-3xl font-bold">Weather Forecast</h1>

          <div className="flex flex-col items-center md:items-start text-sm">
            <p>Current time : {time}</p>
            <p>Last updated : {lastUpdated}</p>
          </div>
        </motion.div>

        <div className="searchSection">
          <input
            type="text"
            className="searchBar"
            value={searchVar}
            onChange={(e) => {
              setSearchVar(e.target.value);
              //console.log(searchVar);
            }}
          />

          <button
            className="searchBtn"
            onClick={() => {
              setApiLink(
                `https://api.weatherapi.com/v1/current.json?key=46fb6895d1de4ad9b14163630230911&q=${searchVar}&aqi=no`
              );
              fetchData();
            }}
          >
            Search
          </button>
        </div>
      </header>

      <main className="resultsContainer">
        <div className="temperatureContainer">
          <div className="mt-10">{sunny2}</div>

          <div>
            <div className="flex flex-row items-center justify-center gap-10 mb-8">
              <h1 className="text-5xl font-bold text-center">{temp}</h1>

              <p className="text-center text-sm italic my-3">
                Feels like {feelsLike}
              </p>
            </div>

            <div className="flex flex-row justify-center gap-4 items-center">
              <div>{mapPin}</div>
              <p className="text-center">
                {city},{country}
              </p>
            </div>
          </div>

          <div className="minorDetails">
            <div className="detail">
              <p className="detailName">Wind</p>
              <p className="detailValue">{wind}</p>
            </div>
            <div className="detail">
              <p className="detailName">Humidity</p>
              <p className="detailValue">{humidity}</p>
            </div>
            <div className="detail">
              <p className="detailName">Pressure</p>
              <p className="detailValue">{pressure}</p>
            </div>
          </div>
        </div>
      </main>
    </div>
  );
}

export default App;
